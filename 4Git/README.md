# Sensibility Analysis

## Scripts

Three scripts (at the moment) compose the workflow of the sensibility analysis, which need to be
launched one after the other to perform the full evaluation, but can be used independently if need
be (_see "build" for an example_).

### build.py

```
python3 build.py (--opt-args)
```
This script can be used to generate a problem file fully compatible with the domain "APE full"
(aka using actions, processes and events implementing the full specifics of the assignment)
by submitting few values, namely the number of waiters available and how many total and hot drinks
are requested by each table.
If launched with no parameters a default test problem will be generated.
With the parameters is possible to set:
- problem name and location
- number of waiters
- number of total drinks per table
- number of hot drinks per table

Notice it is also possible to insert those numeric values with a GUI by toggling that with
the command line argument `-g`

### run.py

```
python3 run.py (--opt-args)
```
This scripts allows to automatically run multiple instances of a problem under a domain with enhsp solver
by varying h and g weights of the used A* heuristic algorithm.

If launched with no parameters a default run with the default test problem will be performed, and the results
will be saved in a .txt file (by default in the _output_ folder)

With the parameters is possible to set:
- domain name and location
- problem name and location
- output file name and location
- maximum time to run each instance for
- h and g sets of weights

### parse.py

```
python3 parse.py (--opt-args)
```
With this script it's possibile to parse an output file generated by `run.py`, composing a dictionary that
stores, for each "interesting" parameter of the solution, the values obtained for it by varying **h** and **g**.
That relation is thus plotted and saved as pdf in the folder _graphs_.

With the parameters is possible to set:
- name and location of the file to be parsed
- plots can be set to 3D view instead of the default 2D+color
- LaTeX style can be adopted in those graphs (requires `sudo apt-get install texlive-full`)

## Future possible changes in the python scripting

Stuff to look into

- sensibility analysis "by hand" of each parameter
- create script to automatize the sensibility analysis for a range of values

## ML implementation for "best (g, h) values" retrieval from problem data

Two possible approaches to follow

### Multilinear Regression

Train a multilinear classifier on data such as
(n-of-drinks, n-of-hot-drinks, drink-pos-avg, drink-pos-variance, h, g, solution-quality)

then, for a given problem file:
1. generate a list of, (h, g)
2. evaluate the quality for the touple (problem-data, h, g) on the trained classifier
3. find the (h, g) tuple that had the best quality

pro: makes sense, a relation is surely in place
cons: will have to iterate on different couples (h, g) for a problem

### kNN Classifier

Save, for each training problem, only the (h, g) couple which yield the best quality solution, as
(n-of-drinks, n-of-hot-drinks, drink-pos-avg, drink-pos-variance, h, g)

then, for a given problem file
1. perform kNN classification, finding the closest (k-mode) training instance for everything (but h, g)
2. take the (h, g) of that solution

pro: easier to develop, no training phase required
cons: needs A LOT of data (not a real problem tho, since even for 3 max drinks per table we can have a lot of variability),
    maybe slower

## Dependencies

Python3 is needed to launch those scripts.
ENHSP-19 is also needed to solve the domain-problem couple. By default the position of the planner executable
is assumed at `/root/ENHSP-Public/enhsp`, to change it open `run.py` and modify the `enigne_path` global variable.
